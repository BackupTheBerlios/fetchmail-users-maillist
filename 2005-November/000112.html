<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] fetchmail gets stuck because of malformed spam
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2005-November/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20fetchmail%20gets%20stuck%20because%20of%20malformed%20spam&In-Reply-To=%3C200511101136.jAABaIDm002008%40ns-srv-2.bln1.siemens.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000111.html">
   <LINK REL="Next"  HREF="000116.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] fetchmail gets stuck because of malformed spam</H1>
    <B>Thomas Wolff</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20fetchmail%20gets%20stuck%20because%20of%20malformed%20spam&In-Reply-To=%3C200511101136.jAABaIDm002008%40ns-srv-2.bln1.siemens.de%3E"
       TITLE="[fetchmail-users] fetchmail gets stuck because of malformed spam">towo at towo.net
       </A><BR>
    <I>Thu Nov 10 12:36:18 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000111.html">[fetchmail-users] fetchmail 6.2.9-rc8 available (regression fixes)
</A></li>
        <LI>Next message: <A HREF="000116.html">[fetchmail-users] fetchmail gets stuck because of malformed spam
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112">[ date ]</a>
              <a href="thread.html#112">[ thread ]</a>
              <a href="subject.html#112">[ subject ]</a>
              <a href="author.html#112">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I wrote:
&gt;<i> But I've actually had similar problems a while ago; fetchmail couldn't 
</I>&gt;<i> get past certain spam mails. I had to use a webmail interface to 
</I>&gt;<i> delete them to get any further. Unfortunately, as I needed quick 
</I>&gt;<i> access to my other mails, I did not care to retrieve any of those 
</I>&gt;<i> (using the webmail interface) which I should have sent here for bug 
</I>&gt;<i> analysis, sorry.
</I>
mbarsalou (having a similar problem) wrote:
&gt;<i> Subject: [fetchmail-users] fetchmail stopping on spam
</I>&gt;<i> ...
</I>&gt;<i> This is purely anecdotal, however.
</I>

This problem occurred again yesterday and I have additional evidence now:

reading message <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">pt8569267-1 at pop.kundenserver.de</A>:18 of 43 (1873 octets) . flushed
reading message <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">pt8569267-1 at pop.kundenserver.de</A>:19 of 43 (1293 octets) fetchmail: incorrect header line found while scanning headers
fetchmail: message delimiter found while scanning headers
 flushed
fetchmail: client/server protocol error while fetching from pop.kundenserver.de
fetchmail: Query status=4 (PROTOCOL)

This was with fetchmail 6.2.3 and it stopped fetching mails at this point. 
There are two additional observations to note:
* Although fetchmail said &quot;flushed&quot; for all the previous mails (and 
  even the affected one, actually), it did not delete them from the 
  server.
* It left the affected message in the mailbox though (or at least 
  some initial part of the headers) (domain name changed manually):

Return-Path: &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">OCHEAQCSILRFCN at notredameacademy.com</A>&gt;
Delivery-Date: Tue, 08 Nov 2005 17:25:36 +0100
Received: from pop.kundenserver.de [212.227.15.181]
	by localhost with POP3 (fetchmail-6.2.3)
	for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">root at localhost</A> (single-drop); Thu, 10 Nov 2005 00:13:00 +0100 (CET)
Received: from [83.242.73.87] (helo=host-n2-73-87.telpol.net.pl)
	by mx.kundenserver.de (node=mxeu3) with ESMTP (Nemesis),
	id 0MKqIe-1EZWHr1aO4-0001NV for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">thomas at xxxx.net</A>; Tue, 08 Nov 2005 17:25:31 +0100
Received: from peternixon.net [215.199.192.160


Then I switched to fetchmail 6.2.9rc7 and it fetched all mails as it 
should do, except the affected message, on which it still reported:
fetchmail: message delimiter found while scanning headers

What still concerns me, however, is that it discarded that message 
completely and wrote no trace of it to the mailbox, so messages with 
that kind of problem (whatever it may be) can not be checked or 
analysed anymore with fetchmail.


Kind regards,
Thomas Wolff

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000111.html">[fetchmail-users] fetchmail 6.2.9-rc8 available (regression fixes)
</A></li>
	<LI>Next message: <A HREF="000116.html">[fetchmail-users] fetchmail gets stuck because of malformed spam
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#112">[ date ]</a>
              <a href="thread.html#112">[ thread ]</a>
              <a href="subject.html#112">[ subject ]</a>
              <a href="author.html#112">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
