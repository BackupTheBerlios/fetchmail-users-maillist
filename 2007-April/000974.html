<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Exchange Server 2003 IMAP NTLM - can someone offer me a test account?
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2007-April/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Exchange%20Server%202003%20IMAP%20NTLM%20-%20can%20someone%0A%20offer%20me%20a%20test%20account%3F&In-Reply-To=%3C461C1378.9080901%40gmx.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000973.html">
   <LINK REL="Next"  HREF="000975.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Exchange Server 2003 IMAP NTLM - can someone offer me a test account?</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Exchange%20Server%202003%20IMAP%20NTLM%20-%20can%20someone%0A%20offer%20me%20a%20test%20account%3F&In-Reply-To=%3C461C1378.9080901%40gmx.de%3E"
       TITLE="[fetchmail-users] Exchange Server 2003 IMAP NTLM - can someone offer me a test account?">matthias.andree at gmx.de
       </A><BR>
    <I>Wed Apr 11 00:45:12 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000973.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM
</A></li>
        <LI>Next message: <A HREF="000975.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM - can someone offer me a test account?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#974">[ date ]</a>
              <a href="thread.html#974">[ thread ]</a>
              <a href="subject.html#974">[ subject ]</a>
              <a href="author.html#974">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ben Russo schrieb:
&gt;<i> Help?
</I>&gt;<i> 
</I>&gt;<i> I can open Outlook or use a browser to log into my account
</I>&gt;<i> So I know that my username and password are correct.
</I>&gt;<i> (I have tried to modify some of the info like password hashes and 
</I>&gt;<i> usernames/hostnames to maintain some security for my company)
</I>&gt;<i> 
</I>&gt;<i> Username:  user1
</I>&gt;<i> Domain:    win2k
</I>&gt;<i> 
</I>&gt;<i> This works fine.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> When I try to login to the server it fails?
</I>&gt;<i> 
</I>&gt;<i> [<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">root at linuxdesktop</A> ~]# /usr/local/bin/fetchmail -v -v -v -c  -p IMAP -L 
</I>&gt;<i> Fetchlog --auth ntlm -u &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>&quot; mailserver.win2k.domain.com
</I>&gt;<i> fetchmail: WARNING: Running as root is discouraged.
</I>&gt;<i> Enter password for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>@mailserver.win2k.domain.com:
</I>&gt;<i> fetchmail: 6.3.8 querying mailserver.win2k.domain.com (protocol IMAP) at 
</I>&gt;<i> Tue 10 Apr 2007 01:54:03 PM EDT: poll started
</I>&gt;<i> fetchmail: Trying to connect to 172.17.7.217/143...connected.
</I>&gt;<i> fetchmail: IMAP&lt; * OK Microsoft Exchange Server 2003 IMAP4rev1 server 
</I>&gt;<i> version 6.5.7638.1 (mailserver.win2k.domain.com) ready.
</I>&gt;<i> fetchmail: IMAP&gt; A0001 CAPABILITY
</I>&gt;<i> fetchmail: IMAP&lt; * CAPABILITY IMAP4 IMAP4rev1 IDLE LOGIN-REFERRALS 
</I>&gt;<i> MAILBOX-REFERRALS NAMESPACE LITERAL+ UIDPLUS CHILDREN AUTH=NTLM
</I>&gt;<i> fetchmail: IMAP&lt; A0001 OK CAPABILITY completed.
</I>&gt;<i> fetchmail: Protocol identified as IMAP4 rev 1
</I>&gt;<i> fetchmail: IMAP&gt; A0002 AUTHENTICATE NTLM
</I>&gt;<i> fetchmail: IMAP&lt; +
</I>&gt;<i> NTLM Request:
</I>&gt;<i>        Ident = NTLMSSP
</I>&gt;<i>        mType = 1
</I>&gt;<i>        Flags = 0000b207
</I>&gt;<i>         User = user1
</I>&gt;<i>       Domain = win2k
</I>&gt;<i> fetchmail: IMAP&gt; BIGxLONGxHASHxOFxCHARS
</I>&gt;<i> fetchmail: IMAP&lt; + BIGGERxLONGERxHASHxOFxCHARSxREALLYxLONG
</I>&gt;<i> NTLM Challenge:
</I>&gt;<i>        Ident = NTLMSSP
</I>&gt;<i>        mType = 2
</I>&gt;<i>       Domain = WIN2K
</I>&gt;<i>        Flags = 02818205
</I>&gt;<i>    Challenge = 63 47 0c 69 22 98 58 37
</I>&gt;<i> NTLM Response:
</I>&gt;<i>        Ident = NTLMSSP
</I>&gt;<i>        mType = 3
</I>&gt;<i>       LmResp = b6 b6 34 22 cd 1e 80 b1 23 d8 3f db aa be c3 45 9e e4 78 
</I>&gt;<i> 6b f9 ac c4 aa
</I>&gt;<i>       NTResp = 95 5a 76 22 71 12 fb b4 8e 26 0a 8a 22 eb 57 ec 49 ce d0 
</I>&gt;<i> 45 ac 48 32 51
</I>&gt;<i>       Domain = win2k
</I>&gt;<i>         User = user1
</I>&gt;<i>          Wks = user1
</I>&gt;<i>         sKey =
</I>&gt;<i>        Flags = 02818205
</I>&gt;<i> fetchmail: IMAP&gt; ANOTHERxBIGxLONGxHASHxOFxCHARSxREALLYxLONGxTOO
</I>&gt;<i> fetchmail: IMAP&lt; A0002 NO Logon failure: unknown user name or bad password.
</I>&gt;<i> fetchmail: IMAP&gt; A0003 *
</I>&gt;<i> fetchmail: Authorization failure on <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>@mailserver.win2k.domain.com
</I>&gt;<i> fetchmail: IMAP&gt; A0004 LOGOUT
</I>&gt;<i> fetchmail: IMAP&lt; A0003 BAD Protocol Error: &quot;Unknown command found&quot;.
</I>&gt;<i> fetchmail: IMAP&lt; * BYE Microsoft Exchange Server 2003 IMAP4rev1 server 
</I>&gt;<i> version 6.5.7638.1 signing off.
</I>&gt;<i> fetchmail: IMAP&lt; A0004 OK LOGOUT completed.
</I>&gt;<i> fetchmail: 6.3.8 querying mailserver.win2k.domain.com (protocol IMAP) at 
</I>&gt;<i> Tue 10 Apr 2007 01:54:03 PM EDT: poll completed
</I>&gt;<i> fetchmail: normal termination, status 3
</I>
Ben,

sorry to hear of authentication troubles - apparently there's something
wrong in fetchmail. To my excuse, I have contradictory information as to
what goes into the Wks=... field and no authoritative reference on the
NTLM authentication dialogue.

Anyone: Can someone provide me a test account for IMAP access to an
Exchange 2003 server or point me to /authoritative/ documentation as to
the NTLM authentication in IMAP?
I only need IMAP access and a valid mailbox with perhaps a test message.
If you can offer that, please contact me off-list.
I can tunnel with OpenVPN, SSH or Cisco VPN if needed and perhaps also
IPSec.

My only NTLM-enabled servers I can test on are Cyrus IMAPd which are
apparently more forgiving than Exchange 2003.

Ben, if you could capture your Outlook's authentication procedure (DO
NOT USE SAVED PASSWORDS AND DO ENTER SOME BOGUS DATA INSTEAD SUCH AS
foobar- DO NOT USE YOUR REAL PASSWORD) with Wireshark (or Windump or
tcpdump - try windump -w output.dump -s 2000) zip the output file and
mail to me offlist.

Thanks.

Best regards,
Matthias Andree

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000973.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM
</A></li>
	<LI>Next message: <A HREF="000975.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM - can someone offer me a test account?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#974">[ date ]</a>
              <a href="thread.html#974">[ thread ]</a>
              <a href="subject.html#974">[ subject ]</a>
              <a href="author.html#974">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
