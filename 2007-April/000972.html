<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Exchange Server 2003 IMAP NTLM
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2007-April/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Exchange%20Server%202003%20IMAP%20NTLM&In-Reply-To=%3C461BD117.70404%40muppethouse.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000971.html">
   <LINK REL="Next"  HREF="000973.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Exchange Server 2003 IMAP NTLM</H1>
    <B>Ben Russo</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Exchange%20Server%202003%20IMAP%20NTLM&In-Reply-To=%3C461BD117.70404%40muppethouse.com%3E"
       TITLE="[fetchmail-users] Exchange Server 2003 IMAP NTLM">ben at muppethouse.com
       </A><BR>
    <I>Tue Apr 10 20:01:59 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000971.html">[fetchmail-users] fetchmail 6.3.8 security fix release
</A></li>
        <LI>Next message: <A HREF="000973.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#972">[ date ]</a>
              <a href="thread.html#972">[ thread ]</a>
              <a href="subject.html#972">[ subject ]</a>
              <a href="author.html#972">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Help?

I can open Outlook or use a browser to log into my account
So I know that my username and password are correct.
(I have tried to modify some of the info like password hashes and 
usernames/hostnames to maintain some security for my company)

Username:  user1
Domain:    win2k

This works fine.


When I try to login to the server it fails?

[<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">root at linuxdesktop</A> ~]# /usr/local/bin/fetchmail -v -v -v -c  -p IMAP -L 
Fetchlog --auth ntlm -u &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>&quot; mailserver.win2k.domain.com
fetchmail: WARNING: Running as root is discouraged.
Enter password for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>@mailserver.win2k.domain.com:
fetchmail: 6.3.8 querying mailserver.win2k.domain.com (protocol IMAP) at 
Tue 10 Apr 2007 01:54:03 PM EDT: poll started
fetchmail: Trying to connect to 172.17.7.217/143...connected.
fetchmail: IMAP&lt; * OK Microsoft Exchange Server 2003 IMAP4rev1 server 
version 6.5.7638.1 (mailserver.win2k.domain.com) ready.
fetchmail: IMAP&gt; A0001 CAPABILITY
fetchmail: IMAP&lt; * CAPABILITY IMAP4 IMAP4rev1 IDLE LOGIN-REFERRALS 
MAILBOX-REFERRALS NAMESPACE LITERAL+ UIDPLUS CHILDREN AUTH=NTLM
fetchmail: IMAP&lt; A0001 OK CAPABILITY completed.
fetchmail: Protocol identified as IMAP4 rev 1
fetchmail: IMAP&gt; A0002 AUTHENTICATE NTLM
fetchmail: IMAP&lt; +
NTLM Request:
       Ident = NTLMSSP
       mType = 1
       Flags = 0000b207
        User = user1
      Domain = win2k
fetchmail: IMAP&gt; BIGxLONGxHASHxOFxCHARS
fetchmail: IMAP&lt; + BIGGERxLONGERxHASHxOFxCHARSxREALLYxLONG
NTLM Challenge:
       Ident = NTLMSSP
       mType = 2
      Domain = WIN2K
       Flags = 02818205
   Challenge = 63 47 0c 69 22 98 58 37
NTLM Response:
       Ident = NTLMSSP
       mType = 3
      LmResp = b6 b6 34 22 cd 1e 80 b1 23 d8 3f db aa be c3 45 9e e4 78 
6b f9 ac c4 aa
      NTResp = 95 5a 76 22 71 12 fb b4 8e 26 0a 8a 22 eb 57 ec 49 ce d0 
45 ac 48 32 51
      Domain = win2k
        User = user1
         Wks = user1
        sKey =
       Flags = 02818205
fetchmail: IMAP&gt; ANOTHERxBIGxLONGxHASHxOFxCHARSxREALLYxLONGxTOO
fetchmail: IMAP&lt; A0002 NO Logon failure: unknown user name or bad password.
fetchmail: IMAP&gt; A0003 *
fetchmail: Authorization failure on <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user1 at win2k</A>@mailserver.win2k.domain.com
fetchmail: IMAP&gt; A0004 LOGOUT
fetchmail: IMAP&lt; A0003 BAD Protocol Error: &quot;Unknown command found&quot;.
fetchmail: IMAP&lt; * BYE Microsoft Exchange Server 2003 IMAP4rev1 server 
version 6.5.7638.1 signing off.
fetchmail: IMAP&lt; A0004 OK LOGOUT completed.
fetchmail: 6.3.8 querying mailserver.win2k.domain.com (protocol IMAP) at 
Tue 10 Apr 2007 01:54:03 PM EDT: poll completed
fetchmail: normal termination, status 3





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000971.html">[fetchmail-users] fetchmail 6.3.8 security fix release
</A></li>
	<LI>Next message: <A HREF="000973.html">[fetchmail-users] Exchange Server 2003 IMAP NTLM
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#972">[ date ]</a>
              <a href="thread.html#972">[ thread ]</a>
              <a href="subject.html#972">[ subject ]</a>
              <a href="author.html#972">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
