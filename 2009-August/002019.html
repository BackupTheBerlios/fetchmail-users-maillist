<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Authentication failure against an ssl-enabled	MS-Exchange server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2009-August/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Authentication%20failure%20against%20an%20ssl-enabled%0A%09MS-Exchange%20server&In-Reply-To=%3C20090807055125.GA9862%40cja.vc%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002018.html">
   <LINK REL="Next"  HREF="002020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Authentication failure against an ssl-enabled	MS-Exchange server</H1>
    <B>Charlie Ambrose</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Authentication%20failure%20against%20an%20ssl-enabled%0A%09MS-Exchange%20server&In-Reply-To=%3C20090807055125.GA9862%40cja.vc%3E"
       TITLE="[fetchmail-users] Authentication failure against an ssl-enabled	MS-Exchange server">C.Ambrose at latrobe.edu.au
       </A><BR>
    <I>Fri Aug  7 07:51:25 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002018.html">[fetchmail-users] Need info
</A></li>
        <LI>Next message: <A HREF="002020.html">[fetchmail-users] Authentication failure against an ssl-enabled MS-Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2019">[ date ]</a>
              <a href="thread.html#2019">[ thread ]</a>
              <a href="subject.html#2019">[ subject ]</a>
              <a href="author.html#2019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings,

Summary of the problem:
=======================
I have been unable to get authenticated on an (ssl-enabled) MS-Exchange server (on which I have
an account). Authentication is fine via the ISP-supplied web-interface and via
Outlook. So I know account details are correct. Any ideas? 

Details:
========

1.   Operating System: GNU/Linux (&gt;uname -a returns Linux nietzsche
     2.6.29-ARCH #1 SMP PREEMPT Wed May 20 07:06:02 UTC 2009 i686 Intel(R)
     Core(TM)2 Duo CPU E6750 @ 2.66GHz GenuineIntel GNU/Linux)

2.   Compiler version: cc (GCC) 4.4.0 20090526 (prerelease)
3.   Name and version of the SMTP listener or MDA am forwarding to: n/a
4,5. Output from . . . 

     &gt; env LC_ALL=C fetchmail -V --auth ntlm

--- snip : start ---
fetchmail: 6.3.11 querying owa.latrobe.edu.au (protocol IMAP) at Fri Aug  7 15:32:30 2009: poll started
Trying to connect to 131.172.7.36/993...connected.
fetchmail: Issuer Organization: Entrust, Inc.
fetchmail: Issuer CommonName: Entrust Certification Authority - L1B
fetchmail: Server CommonName: owa.latrobe.edu.au
fetchmail: Subject Alternative Name: owa.latrobe.edu.au
fetchmail: Subject Alternative Name: autodiscover.latrobe.edu.au
fetchmail: Subject Alternative Name: autodiscover.ltu.edu.au
fetchmail: Subject Alternative Name: htcas1.ltu.edu.au
fetchmail: Subject Alternative Name: htcas2.ltu.edu.au
fetchmail: Subject Alternative Name: htcas3dr.ltu.edu.au
fetchmail: Subject Alternative Name: sip.latrobe.edu.au
fetchmail: owa.latrobe.edu.au key fingerprint: A8:1F:A4:F2:E5:55:EE:DF:AB:B3:3C:EC:3C:AA:33:52
fetchmail: owa.latrobe.edu.au fingerprints match.
fetchmail: IMAP&lt; * OK The Microsoft Exchange IMAP4 service is ready.
fetchmail: IMAP&gt; A0001 CAPABILITY
fetchmail: IMAP&lt; * CAPABILITY IMAP4 IMAP4rev1 AUTH=NTLM AUTH=GSSAPI AUTH=PLAIN IDLE NAMESPACE LITERAL+
fetchmail: IMAP&lt; A0001 OK CAPABILITY completed.
fetchmail: Protocol identified as IMAP4 rev 1
fetchmail: IMAP&gt; A0002 AUTHENTICATE NTLM
fetchmail: IMAP&lt; +
NTLM Request:
      Ident = NTLMSSP
      mType = 1
      Flags = 0000b207
       User = C2Ambrose
     Domain = LTU
fetchmail: IMAP&gt; TlRMTVNTUAABAAAAB7IAAAkACQAgAAAAAwADACkAAABDMkFtYnJvc2VMVFU=
fetchmail: IMAP&lt; + TlRMTVNTUAACAAAABgAGADgAAAAFgoECmQvZ0t81U6AAAAAAAAAAAIAAgAA+AAAABgBxFwAAAA9MAFQAVQACAAYATABUAFUAAQAMAEgAVABDAEEAUwAyAAQAFABsAHQAdQAuAGUAZAB1AC4AYQB1AAMAIgBIAFQAQwBhAHMAMgAuAGwAdAB1AC4AZQBkAHUALgBhAHUABQAUAGwAdAB1AC4AZQBkAHUALgBhAHUABwAIAL2QeXUgF8oBAAAAAA==
NTLM Challenge:
      Ident = NTLMSSP
      mType = 2
     Domain = LTU
      Flags = 02818205
  Challenge = 99 0b d9 d2 df 35 53 a0 
NTLM Response:
      Ident = NTLMSSP
      mType = 3
     LmResp = 7b 4f 82 74 bc 25 33 9e bd 62 7b 3f 1f 6a 30 cd 7e 44 13 b1 aa 56 a4 1a 
     NTResp = 74 9d 7a 16 e8 54 64 2d da f5 99 c4 a6 d0 24 13 7f 25 93 bb dc c5 a7 0e 
     Domain = LTU
       User = C2Ambrose
        Wks = C2Ambrose
       sKey = 
      Flags = 02818205
fetchmail: IMAP&gt; TlRMTVNTUAADAAAAGAAYAEAAAAAYABgAWAAAAAYABgBwAAAAEgASAHYAAAASABIAiAAAAAAAAABaAAAABYKBAntPgnS8JTOevWJ7Px9qMM1+RBOxqlakGnSdehboVGQt2vWZxKbQJBN/JZO73MWnDkwAVABVAEMAMgBBAG0AYgByAG8AcwBlAEMAMgBBAG0AYgByAG8AcwBlAA==
fetchmail: IMAP&lt; A0002 NO AUTHENTICATE failed.
fetchmail: IMAP&gt; A0003 *
fetchmail: IMAP&gt; A0004 LOGOUT
fetchmail: IMAP&lt; A0003 BAD Command Error. 12
fetchmail: IMAP&lt; * BYE Microsoft Exchange Server 2007 IMAP4 server signing off.
fetchmail: IMAP&lt; A0004 OK LOGOUT completed.
fetchmail: 6.3.11 querying owa.latrobe.edu.au (protocol IMAP) at Fri Aug  7 15:32:31 2009: poll completed
fetchmail: Query status=3 (AUTHFAIL)
fetchmail: normal termination, status 3
--- snip : stop ---

6. Output from . . . 

   &gt; env LC_ALL=C fetchmail --nodetach -vvv --nosyslog

--- snip : start ---
fetchmail: 6.3.11 querying owa.latrobe.edu.au (protocol IMAP) at Fri Aug  7 15:32:11 2009: poll started
Trying to connect to 131.172.7.36/993...connected.
fetchmail: Issuer Organization: Entrust, Inc.
fetchmail: Issuer CommonName: Entrust Certification Authority - L1B
fetchmail: Server CommonName: owa.latrobe.edu.au
fetchmail: Subject Alternative Name: owa.latrobe.edu.au
fetchmail: Subject Alternative Name: autodiscover.latrobe.edu.au
fetchmail: Subject Alternative Name: autodiscover.ltu.edu.au
fetchmail: Subject Alternative Name: htcas1.ltu.edu.au
fetchmail: Subject Alternative Name: htcas2.ltu.edu.au
fetchmail: Subject Alternative Name: htcas3dr.ltu.edu.au
fetchmail: Subject Alternative Name: sip.latrobe.edu.au
fetchmail: owa.latrobe.edu.au key fingerprint: A8:1F:A4:F2:E5:55:EE:DF:AB:B3:3C:EC:3C:AA:33:52
fetchmail: owa.latrobe.edu.au fingerprints match.
fetchmail: IMAP&lt; * OK The Microsoft Exchange IMAP4 service is ready.
fetchmail: IMAP&gt; A0001 CAPABILITY
fetchmail: IMAP&lt; * CAPABILITY IMAP4 IMAP4rev1 AUTH=NTLM AUTH=GSSAPI AUTH=PLAIN IDLE NAMESPACE LITERAL+
fetchmail: IMAP&lt; A0001 OK CAPABILITY completed.
fetchmail: Protocol identified as IMAP4 rev 1
fetchmail: IMAP&gt; A0002 AUTHENTICATE NTLM
fetchmail: IMAP&lt; +
NTLM Request:
      Ident = NTLMSSP
      mType = 1
      Flags = 0000b207
       User = C2Ambrose
     Domain = LTU
fetchmail: IMAP&gt; TlRMTVNTUAABAAAAB7IAAAkACQAgAAAAAwADACkAAABDMkFtYnJvc2VMVFU=
fetchmail: IMAP&lt; + TlRMTVNTUAACAAAABgAGADgAAAAFgoEC0f2H1amvNJ8AAAAAAAAAAIAAgAA+AAAABgBxFwAAAA9MAFQAVQACAAYATABUAFUAAQAMAEgAVABDAEEAUwAyAAQAFABsAHQAdQAuAGUAZAB1AC4AYQB1AAMAIgBIAFQAQwBhAHMAMgAuAGwAdAB1AC4AZQBkAHUALgBhAHUABQAUAGwAdAB1AC4AZQBkAHUALgBhAHUABwAIAP1bTGogF8oBAAAAAA==
NTLM Challenge:
      Ident = NTLMSSP
      mType = 2
     Domain = LTU
      Flags = 02818205
  Challenge = d1 fd 87 d5 a9 af 34 9f 
NTLM Response:
      Ident = NTLMSSP
      mType = 3
     LmResp = ed d7 7c 30 74 09 d9 ce ac 85 36 81 23 60 48 0d 47 98 4c e1 2d eb c6 82 
     NTResp = 0d ee 29 44 3a a0 f7 cf 0d 48 3b 27 a7 07 8f 53 61 ae 72 77 02 f5 a6 7e 
     Domain = LTU
       User = C2Ambrose
        Wks = C2Ambrose
       sKey = 
      Flags = 02818205
fetchmail: IMAP&gt; TlRMTVNTUAADAAAAGAAYAEAAAAAYABgAWAAAAAYABgBwAAAAEgASAHYAAAASABIAiAAAAAAAAABaAAAABYKBAu3XfDB0CdnOrIU2gSNgSA1HmEzhLevGgg3uKUQ6oPfPDUg7J6cHj1NhrnJ3AvWmfkwAVABVAEMAMgBBAG0AYgByAG8AcwBlAEMAMgBBAG0AYgByAG8AcwBlAA==
fetchmail: IMAP&lt; A0002 NO AUTHENTICATE failed.
fetchmail: IMAP&gt; A0003 *
fetchmail: IMAP&gt; A0004 LOGOUT
fetchmail: IMAP&lt; A0003 BAD Command Error. 12
fetchmail: IMAP&lt; * BYE Microsoft Exchange Server 2007 IMAP4 server signing off.
fetchmail: IMAP&lt; A0004 OK LOGOUT completed.
fetchmail: 6.3.11 querying owa.latrobe.edu.au (protocol IMAP) at Fri Aug  7 15:32:12 2009: poll completed
fetchmail: Query status=3 (AUTHFAIL)
fetchmail: normal termination, status 3
--- snip : stop ---

Content of .fetchmailrc
=======================

--- snip : start ---
poll owa.latrobe.edu.au with proto IMAP port 993
user &quot;&lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">user at domain</A>&gt;&quot; there with password '&lt;password&gt;' is '&lt;user-local&gt;' here 
ssl sslfingerprint 'A8:1F:A4:F2:E5:55:EE:DF:AB:B3:3C:EC:3C:AA:33:52'
--- snip : stop ---

Fetchmail version:
==================
This is fetchmail release 6.3.11+NTLM+SSL+NLS.

Thanks,

--Charlie

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002018.html">[fetchmail-users] Need info
</A></li>
	<LI>Next message: <A HREF="002020.html">[fetchmail-users] Authentication failure against an ssl-enabled MS-Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2019">[ date ]</a>
              <a href="thread.html#2019">[ thread ]</a>
              <a href="subject.html#2019">[ subject ]</a>
              <a href="author.html#2019">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
