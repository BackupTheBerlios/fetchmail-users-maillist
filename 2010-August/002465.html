<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Server certificate verification error: self signed certificate
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2010-August/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Server%20certificate%20verification%20error%3A%20self%0A%20signed%20certificate&In-Reply-To=%3C4C74013A.5030803%40gmx.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002464.html">
   <LINK REL="Next"  HREF="002466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Server certificate verification error: self signed certificate</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Server%20certificate%20verification%20error%3A%20self%0A%20signed%20certificate&In-Reply-To=%3C4C74013A.5030803%40gmx.de%3E"
       TITLE="[fetchmail-users] Server certificate verification error: self signed certificate">matthias.andree at gmx.de
       </A><BR>
    <I>Tue Aug 24 19:28:26 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002464.html">[fetchmail-users] Server certificate verification error: self signed certificate
</A></li>
        <LI>Next message: <A HREF="002466.html">[fetchmail-users] Server certificate verification error: self signed certificate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2465">[ date ]</a>
              <a href="thread.html#2465">[ thread ]</a>
              <a href="subject.html#2465">[ subject ]</a>
              <a href="author.html#2465">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am 23.08.2010 08:01, schrieb Rob MacGregor:
&gt;<i> On Sun, Aug 22, 2010 at 23:25, Chris &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">cpollock at embarqmail.com</A>&gt; wrote:
</I>&gt;&gt;<i> I've upgraded this morning from fetchmail 6.3.9 to 6.3.17 and noticed a 
</I>&gt;&gt;<i> change in the logging entries:
</I>&gt;<i> &lt;---SNIP---&gt;
</I>&gt;&gt;<i> Though this doesn't prevent mail from being picked up is there a way I can 
</I>&gt;&gt;<i> get the new certificate? The domain belongs to me however is hosted by 
</I>&gt;&gt;<i> someone else. I've contacted the person who is hosting it for me and 
</I>&gt;&gt;<i> hopefully he'll reply but I'd like to have a fallback way to get the cert 
</I>&gt;&gt;<i> just in case. I currently do not have a certificate for toadnet.com in my 
</I>&gt;&gt;<i> ~/certs/.certs folder.
</I>&gt;<i> 
</I>&gt;<i> The FAQ lists one option
</I>&gt;<i> (<A HREF="http://fetchmail.berlios.de/fetchmail-FAQ.html#K5">http://fetchmail.berlios.de/fetchmail-FAQ.html#K5</A>). I've also used the
</I>&gt;<i> following to get the certificate:
</I>&gt;<i> 
</I>&gt;<i> openssl s_client -connect remote.server.net:993 &lt;/dev/null | sed -ne
</I>&gt;<i> '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p'
</I>&gt;&gt;<i> /my/ssl/path/remote.server.net.pem &amp;&amp; c_rehash
</I>&gt;<i> 
</I>&gt;<i> You'll possibly want to use the servers correct name too 
</I>&gt;<i> (linuxsrv01.usdcservers.net) to avoid the warning about the mis-match.
</I>
Chris, Rob,

I'm sorry to contradict:

A. what you propose, extracting the server's certificate and marking it
trusted (by dropping it into the certs/ directory), is an *insecure
practice.* It is also inefficient for maintenance because server
certificates usually expire quicker than the signing CAs' certificates.

It is also an *insecure practice* to look at the fingerprint in -v mode
and record it, *unless* you have verified the fingerprint through a
separate, secure channel.

Reason: If the download is under attack, the whole setup will be
insecure for the time being and you will only know after the
man-in-the-middle attack has ended.

The certificate needs to be downloaded through a secure link, or at
least the fingerprints verified over a distinct channel.


B. the names of the .pem files in the /path-to/ssl/certs/ are irrelevant
and only used for human convenience to ease maintenance of the directory.
  OpenSSL uses the hash symlinks generated by c_rehash (such as
21337432.0) to look up the certificates, and uses the common name and
subject alternative names from within the certificate.


The recent README.SSL
&lt;<A HREF="http://gitorious.org/fetchmail/fetchmail/blobs/master/README.SSL">http://gitorious.org/fetchmail/fetchmail/blobs/master/README.SSL</A>&gt;
explains a bit more, and the short version is:

0. in this particular case only: have a new certificate issued with the
server's DNS as its common name or subject alternative name

1. get the CA certificate that was used to sign the server's certificate
and drop it into /etc/ssl/certs (or wherever your OpenSSL keeps that),
or append it (in PEM format) to /etc/ssl/cert.pem (or wherever your
OpenSSL keeps that).  If you want to keep these separate, the
--sslcertfile and --sslcertpath options are at your service.

2. if it's a separate file in the certs directory, or you're using
--sslcertpath, run c_rehash on the same directory (c_rehash /etc/ssl/certs)

Hope that helps.

Best regards
Matthias

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002464.html">[fetchmail-users] Server certificate verification error: self signed certificate
</A></li>
	<LI>Next message: <A HREF="002466.html">[fetchmail-users] Server certificate verification error: self signed certificate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2465">[ date ]</a>
              <a href="thread.html#2465">[ thread ]</a>
              <a href="subject.html#2465">[ subject ]</a>
              <a href="author.html#2465">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
