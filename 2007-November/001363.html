<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Suddenly can't connect to Exchange server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Suddenly%20can%27t%20connect%20to%20Exchange%20server&In-Reply-To=%3CEDFF1318-EAC4-4370-A3F6-5CE6250718F1%40clark-communications.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001362.html">
   <LINK REL="Next"  HREF="001364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Suddenly can't connect to Exchange server</H1>
    <B>Don Jackson</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Suddenly%20can%27t%20connect%20to%20Exchange%20server&In-Reply-To=%3CEDFF1318-EAC4-4370-A3F6-5CE6250718F1%40clark-communications.com%3E"
       TITLE="[fetchmail-users] Suddenly can't connect to Exchange server">fetchmail-users at clark-communications.com
       </A><BR>
    <I>Fri Nov  2 21:54:02 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001362.html">[fetchmail-users] Suddenly can't connect to Exchange server
</A></li>
        <LI>Next message: <A HREF="001364.html">[fetchmail-users] Suddenly can't connect to Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1363">[ date ]</a>
              <a href="thread.html#1363">[ thread ]</a>
              <a href="subject.html#1363">[ subject ]</a>
              <a href="author.html#1363">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Further info on this problem:

When I connect to the same Exchange server using Thunderbird, tbird  
is configured to use TLS, and connects via TLS to port 143.

So that is a bit different than what I have fetchmail doing below  
(although that USED to work!)

When I edit my .fetchmailrc to attempt to duplicate what tbird is  
doing, here is what happens:

$ fetchmail -v -v -c
fetchmail: 6.3.8 querying mail.bigco.com (protocol IMAP) at Fri Nov   
2 13:37:30 2007: poll started
Trying to connect to 1.2.3.4/143...connected.

But then it just hangs there.  I don't seem to receive an OK from the  
server to start the whole IMAP handshake.

Here is my .fetchmailrc

	poll mail.bigco.com protocol imap service 143 user &quot;myuserid&quot;   
password &quot;mypassword&quot; ssl sslproto &quot;SSL3&quot;

Changing &quot;SSL3&quot; to &quot;TLS1&quot; or SSL23 doesn't seem to change anything.



On Nov 2, 2007, at 12:12 PM, Don Jackson wrote:

&gt;<i>
</I>&gt;<i> For 6+ months I have connected to a corporate Exchange server with
</I>&gt;<i> fetchmail, version 6.3.8,running on OpenBSD 4.1
</I>&gt;<i>
</I>&gt;<i> With absolutely no change to the machine running fetchmail, suddenly
</I>&gt;<i> fetchmail was unable to get mail from Exchange.
</I>&gt;<i>
</I>&gt;<i> Here is an example interaction (with names and ip addresses changed
</I>&gt;<i> to protect the guilty)
</I>&gt;<i>
</I>&gt;&gt;<i> fetchmail -v -c
</I>&gt;&gt;<i> fetchmail: 6.3.8 querying mail.bigco.com (protocol IMAP) at Thu
</I>&gt;&gt;<i> Nov  1 16:36:05 2007: poll started
</I>&gt;&gt;<i> Trying to connect to 1.2.3.4/993...connected.
</I>&gt;&gt;<i> fetchmail: SSL connection failed.
</I>&gt;&gt;<i> fetchmail: socket error while fetching from <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">myuserid at mail.bigco.com</A>
</I>&gt;&gt;<i> fetchmail: 6.3.8 querying mail.bigco.com (protocol IMAP) at Thu
</I>&gt;&gt;<i> Nov  1 16:36:06 2007: poll completed
</I>&gt;&gt;<i> fetchmail: normal termination, status 2
</I>&gt;<i>
</I>&gt;<i> Here is my fetchmailrc file
</I>&gt;<i>
</I>&gt;<i> 	poll mail.bigco.com protocol imap user &quot;myuserid&quot; password
</I>&gt;<i> &quot;mypassword&quot; options ssl
</I>&gt;<i> 	smtphost localhost/2500
</I>&gt;<i> 	smtpname <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">myuserid at somedomain.com</A>
</I>&gt;<i>
</I>&gt;<i> I am able to access my mailbox via Outlook, and from another machine
</I>&gt;<i> running Thunderbird (thunderbird configured to use IMAP over TLS)
</I>&gt;<i>
</I>&gt;<i> So what could be the problem?
</I>&gt;<i>
</I>&gt;<i> This is really cramping my style, so I would be very grateful for any
</I>&gt;<i> advice.
</I>&gt;<i>
</I>&gt;<i> Best regards,
</I>&gt;<i>
</I>&gt;<i> Don
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> fetchmail-users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">fetchmail-users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">https://lists.berlios.de/mailman/listinfo/fetchmail-users</A>
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001362.html">[fetchmail-users] Suddenly can't connect to Exchange server
</A></li>
	<LI>Next message: <A HREF="001364.html">[fetchmail-users] Suddenly can't connect to Exchange server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1363">[ date ]</a>
              <a href="thread.html#1363">[ thread ]</a>
              <a href="subject.html#1363">[ subject ]</a>
              <a href="author.html#1363">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
