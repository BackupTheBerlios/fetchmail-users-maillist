<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Add headers in notification for oversized	messages deletet by limitflush
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Add%20headers%20in%20notification%20for%0A%20oversized%09messages%20deletet%20by%20limitflush&In-Reply-To=%3C492C3444.4000500%40gmx.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001753.html">
   <LINK REL="Next"  HREF="001755.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Add headers in notification for oversized	messages deletet by limitflush</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Add%20headers%20in%20notification%20for%0A%20oversized%09messages%20deletet%20by%20limitflush&In-Reply-To=%3C492C3444.4000500%40gmx.de%3E"
       TITLE="[fetchmail-users] Add headers in notification for oversized	messages deletet by limitflush">matthias.andree at gmx.de
       </A><BR>
    <I>Tue Nov 25 18:22:12 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001753.html">[fetchmail-users] Add headers in notification for oversized	messages deletet by limitflush
</A></li>
        <LI>Next message: <A HREF="001755.html">[fetchmail-users] Add headers in notification for oversized messages deletet by limitflush
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1754">[ date ]</a>
              <a href="thread.html#1754">[ thread ]</a>
              <a href="subject.html#1754">[ subject ]</a>
              <a href="author.html#1754">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Boxhorn-EDV | Bernhard Boxhorn schrieb:
&gt;<i>  
</I>&gt;&gt;<i> &quot;Rob MacGregor&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">rob.macgregor at gmail.com</A>&gt; writes:
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> On Fri, Nov 21, 2008 at 08:17, Boxhorn-EDV | Bernhard Boxhorn 
</I>&gt;&gt;&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">bernhard at boxhorn-edv.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> Hi fetchmail list,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> we&#180;re using fetchmail for smaller servers to pull mails from the pop 
</I>&gt;&gt;&gt;<i> servers to their mailboxes, mostly when we don&#180;t have control over 
</I>&gt;&gt;&gt;<i> the MX settings.
</I>&gt;&gt;&gt;<i> To keep their mailboxes small and prevent the users for missusing 
</I>&gt;&gt;&gt;<i> e-mail for data transfers with large files we limit the local MTA to 
</I>&gt;&gt;&gt;<i> e.g. 10 MB.
</I>&gt;&gt;&gt;<i> Often the MX allows bigger messages. So if there are bigger messages 
</I>&gt;&gt;&gt;<i> we delete them with the --limitflush option, user gets a notification
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> that a oversized message has been deleted.
</I>&gt;&gt;&gt;<i> Everything fine until now.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The Problem is: The user has no clue who was the original sender and 
</I>&gt;&gt;&gt;<i> the sender does not get any error message.
</I>&gt;&gt;&gt;<i> So user knows there was a big message and it has been deleted and 
</I>&gt;&gt;&gt;<i> sender thinks user received the message, there is a lack of
</I>&gt;<i> information.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> The best approach for you is probably to configure the local MTA with 
</I>&gt;&gt;<i> the size limit, but not configure fetchmail with limits.  That way 
</I>&gt;&gt;<i> fetchmail will attempt the delivery and a bounce message will be 
</I>&gt;&gt;<i> generated to the original sender.
</I>&gt;<i> 
</I>&gt;&gt;<i> I'm not sure how this can actually work.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Fetchmail uses the ESMTP SIZE extension if advertised by the SMTP sink,
</I>&gt;<i> so it might see the rejection before the DATA phaset already -- and
</I>&gt;<i> waiving the &quot;attempt the delivery&quot; part of your assumption.
</I>&gt;<i> 
</I>&gt;&gt;<i> WRT Bernhard's ideas, I sympathize with NOT abusing mail for bulk
</I>&gt;<i> transfers, OTOH &quot;to keep their mailboxes small&quot; isn't a motivation to
</I>&gt;<i> justify that -- technical problems around large messages &gt;can be solved
</I>&gt;<i> with efficient indexing Maildir-based IMAP servers such as Dovecot 1.1.
</I>&gt;<i> 
</I>&gt;<i> Hi Matthias,
</I>&gt;<i> 
</I>&gt;<i> Sorry for my formal errors, trying to improve.
</I>
OK, let me remind everyone that the list admins are free to unsubscribe
anyone disrupting the list experience, including Outlook (ab)use like
broken quotings as seen above.

Not sure if it's Outlook's or Communigate's fault, and it's not that I care
much. If you don't know what to do, here's a simple hint: do not use
Outlook. Thunderbird will do, and there's a nice &quot;Reply to mailing list&quot;
add-on, too...

If it annoys me too much, I'll just stop responding. And I did consider not
responding to the &quot;post below quote&quot; message...

&gt;<i> youre remark with the IMAP server is not exactly helping us, we're using
</I>&gt;<i> fetchmail for various mail storage systems like Exchange, Communigate,
</I>&gt;<i> Cyrus IMAP... The Problem with the users is that they missuse mails for
</I>&gt;<i> big attachements and leave them stored in their mailbox, we set quotas
</I>&gt;<i> but they always cry for bigger mailboxes...
</I>
That's not fetchmail's or a technical problem, but a social one --
sometimes paired with a technical one (inferior IMAP servers).

&gt;<i> Here you find a log for a oversized mail (BTW, we're using different
</I>&gt;<i> versions of fetchmail, the problem is the same with all versions):
</I>
Thanks.

&gt;<i> idefix ~ # fetchmail -d0 --limit 100 --limitflush -f /etc/fetchmailrc
</I>&gt;<i> -vvv
</I>&gt;<i> fetchmail: WARNING: Running as root is discouraged.
</I>
What do you need root privileges for? If fetchmail forwards to SMTP, create
an unprivileged user for exclusive fetchmail use, and that's it.

(I should really make fetchmail refuse to run with UID 0, or drop to nobody...)

&gt;<i> fetchmail: 6.3.8 querying post.strato.de (protocol POP3) at Tue 25 Nov
</I>&gt;<i> 2008 03:43:42 PM CET: poll started
</I>&gt;<i> Trying to connect to 81.169.145.136/110...connected.
</I>&gt;<i> fetchmail: POP3&lt; +OK POP3 server ready
</I>&gt;<i> &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">4125144.13279.1227624224 at post.webmailer.de</A>&gt;
</I>&gt;<i> fetchmail: POP3&gt; CAPA
</I>&gt;<i> fetchmail: POP3&lt; +OK Capability list follows:
</I>&gt;<i> fetchmail: POP3&lt; EXPIRE 7
</I>&gt;<i> fetchmail: POP3&lt; PIPELINING
</I>&gt;<i> fetchmail: POP3&lt; RESP-CODES
</I>&gt;<i> fetchmail: POP3&lt; TOP
</I>&gt;<i> fetchmail: POP3&lt; USER
</I>&gt;<i> fetchmail: POP3&lt; UIDL
</I>&gt;<i> fetchmail: POP3&lt; SASL CRAM-MD5
</I>&gt;<i> fetchmail: POP3&lt; .
</I>&gt;<i> fetchmail: post.strato.de: opportunistic upgrade to TLS failed, trying
</I>&gt;<i> to continue.
</I>
Unrelated to your problem, but what's that? Fetchmail tries opportunistic
TLS if not advertised? I have to think about that.

&gt;<i> fetchmail: POP3&gt; AUTH CRAM-MD5
</I>&gt;<i> fetchmail: POP3&lt; +
</I>&gt;<i> PDQxMjUxNDQuMTMyNzkuMTIyNzYyNDIyNEBwb3N0LndlYm1haWxlci5kZT4=
</I>&gt;<i> fetchmail: decoded as &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">4125144.13279.1227624224 at post.webmailer.de</A>&gt;
</I>&gt;<i> fetchmail: POP3&gt;
</I>&gt;<i> bm8taXBAYm94aG9ybi1lZHYuY29tIDdlYjI0YjIyNzUwMDMyZWI5NTQyN2Q2MDg4MzY5MmIz
</I>&gt;<i> fetchmail: POP3&lt; +OK User logged in, proceed.
</I>&gt;<i> fetchmail: selecting or re-polling default folder
</I>&gt;<i> fetchmail: POP3&gt; STAT
</I>&gt;<i> fetchmail: POP3&lt; +OK 1 111713
</I>&gt;<i> fetchmail: POP3&gt; LAST
</I>&gt;<i> fetchmail: POP3&lt; -ERR Syntax error, command unrecognized
</I>&gt;<i> fetchmail: Syntax error, command unrecognized
</I>&gt;<i> fetchmail: POP3&gt; UIDL
</I>&gt;<i> fetchmail: POP3&lt; +OK 1 messages, listing follows
</I>&gt;<i> fetchmail: POP3&lt; 1 ebe0d0d202ee76b2f42ce7ea8c488bf7
</I>&gt;<i> fetchmail: 1 is unseen
</I>&gt;<i> fetchmail: POP3&lt; .
</I>&gt;<i> 1 message for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">no-ip at boxhorn-edv.com</A> at post.strato.de (111713 octets).
</I>&gt;<i> fetchmail: POP3&gt; LIST 1
</I>&gt;<i> fetchmail: POP3&lt; +OK 1 111713
</I>&gt;<i> skipping message <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">no-ip at boxhorn-edv.com</A>@post.strato.de:1 (111713 octets)
</I>&gt;<i> (oversized) flushed
</I>&gt;<i> fetchmail: POP3&gt; DELE 1
</I>&gt;<i> fetchmail: POP3&lt; +OK Message 1 deleted
</I>&gt;<i> fetchmail: POP3&gt; QUIT
</I>&gt;<i> fetchmail: POP3&lt; +OK Closing connection
</I>&gt;<i> fetchmail: 6.3.8 querying post.strato.de (protocol POP3) at Tue 25 Nov
</I>&gt;<i> 2008 03:43:43 PM CET: poll completed
</I>&gt;<i> fetchmail: swapping UID lists
</I>&gt;<i> fetchmail: Query status=1 (NOMAIL)
</I>&gt;<i> fetchmail: Deleting fetchids file.
</I>&gt;<i> fetchmail: normal termination, status 1
</I>&gt;<i> fetchmail: Deleting fetchids file.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And here is the information the user gets:
</I>&gt;<i> 
</I>&gt;<i> The following oversized messages were deleted on server post.strato.de
</I>&gt;<i> account <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">no-ip at boxhorn-edv.com</A>:
</I>&gt;<i> 
</I>&gt;<i>   1 msg 24968586 octets long deleted by fetchmail.
</I>&gt;<i> 
</I>
Yup. Can I see the accompanying /etc/fetchmailrc for this particular
account? If you paste your .fetchmailrc, remember to strip out passwords.
The <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">no-ip at boxhorn-edv.com</A> account and global settings suffice.

Thanks.

-- 
Matthias Andree


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001753.html">[fetchmail-users] Add headers in notification for oversized	messages deletet by limitflush
</A></li>
	<LI>Next message: <A HREF="001755.html">[fetchmail-users] Add headers in notification for oversized messages deletet by limitflush
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1754">[ date ]</a>
              <a href="thread.html#1754">[ thread ]</a>
              <a href="subject.html#1754">[ subject ]</a>
              <a href="author.html#1754">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
