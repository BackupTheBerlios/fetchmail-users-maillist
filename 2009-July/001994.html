<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-users] Problem with large emails
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-users/2009-July/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Problem%20with%20large%20emails&In-Reply-To=%3CBLU0-SMTP981931260699F9A1732C63CE210%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001993.html">
   <LINK REL="Next"  HREF="001995.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-users] Problem with large emails</H1>
    <B>Tony Morehen</B> 
    <A HREF="mailto:fetchmail-users%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-users%5D%20Problem%20with%20large%20emails&In-Reply-To=%3CBLU0-SMTP981931260699F9A1732C63CE210%40phx.gbl%3E"
       TITLE="[fetchmail-users] Problem with large emails">tmorehen at ajmconsulting.ca
       </A><BR>
    <I>Fri Jul 17 01:19:02 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001993.html">[fetchmail-users] maillog entry
</A></li>
        <LI>Next message: <A HREF="001995.html">[fetchmail-users] Problem with large emails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1994">[ date ]</a>
              <a href="thread.html#1994">[ thread ]</a>
              <a href="subject.html#1994">[ subject ]</a>
              <a href="author.html#1994">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm using fetchmail to download my emails from various accounts with 
various ISPs.  For the most part, everything works perfectly.  However, 
I am running into problems with large emails (over 2MB) from one ISP:  
sympatico.ca (a hotmail variant).  Here's what's happening:
1) The download of the large email proceeds normally except for the last 
octet.  That octet generates a socket error 2.
2) The email is not deleted from the online account.
3) The downloaded email is handed off to my MTA and appears to be normal 
(attachments be they exe's or powerpoint files work as they should) and 
are placed into my local IMAP mail account.

4) fetchmail goes to sleep for 3 minutes.
5) fetchmail wakes and sees the email on the server and downloads it 
again, repeating steps 1 to 4.

This goes on indefinitely until I manually delete the file on the server. 

Here's the fetchmail log:

fetchmail: 1 message for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">morehen81 at sympatico.ca</A> at pophm.sympatico.ca 
(6805541 octets).
fetchmail: reading message <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">morehen81 at sympatico.ca</A>@pop.bc.hotmail.com:1 
of 1 (6805541 octets) flushed
fetchmail: socket error while fetching from 
<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-users">morehen81 at sympatico.ca</A>@pophm.sympatico.ca
fetchmail: Query status=2 (SOCKET)

fetchmail seems to think it has flushed (deleted?) the email but it 
hasn't.  In fact, a verbose log shows that fetchmail doesn't even try to 
send a DELE command.

I understand that the basic problem is with hotmail not fetchmail.  
However, there is a problem with how fetchmail reacts to hotmail's  
error.  There are 2 choices. First, If fetchmail is going to hand off 
the email to the MTA, it should delete the email from the server despite 
the socket error.  Alternatively, if fetchmail is not going to delete 
the email from the server, it shout not hand off the email to the MTA.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001993.html">[fetchmail-users] maillog entry
</A></li>
	<LI>Next message: <A HREF="001995.html">[fetchmail-users] Problem with large emails
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1994">[ date ]</a>
              <a href="thread.html#1994">[ thread ]</a>
              <a href="subject.html#1994">[ subject ]</a>
              <a href="author.html#1994">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-users">More information about the fetchmail-users
mailing list</a><br>
</body></html>
